#!/bin/bash

echo "DAT500 Unsupervised Learners Project Script: Load MovieLens data Into Hive from GitHub"

#copy files from github to hive drive, this is the little data set just to test 
wget  -O /usr/ratings.csv "https://raw.githubusercontent.com/chadland/DAT500---Unsupervised-Learners/master/MovieLensSmall/ratings.csv"
wget  -O /usr/movies.csv "https://raw.githubusercontent.com/chadland/DAT500---Unsupervised-Learners/master/MovieLensSmall/movies.csv"
wget  -O /usr/links.csv "https://raw.githubusercontent.com/chadland/DAT500---Unsupervised-Learners/master/MovieLensSmall/links.csv"
wget  -O /usr/tags.csv "https://raw.githubusercontent.com/chadland/DAT500---Unsupervised-Learners/master/MovieLensSmall/tags.csv"
wget -O /usr/storeGitHubFilesIntoHiveSQLtables.sql  "https://raw.githubusercontent.com/chadland/DAT500---Unsupervised-Learners/master/HadoopSandboxScripts/storeGitHubFilesIntoHiveSQLtables.sql"

#copy to hive file system from downloaded path
hadoop fs -put -f /usr/*.csv /user/hive

#start hive
hive -f /usr/storeGitHubFilesIntoHiveSQLtables.sql